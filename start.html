<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
<!-- Javascript SDKs-->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script> 
<script src="js/amazon-cognito-auth.min.js"></script>
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.js"></script> 
<script src="js/amazon-cognito-identity.min.js"></script>   
<script src="js/config.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>


<title>Start</title>
<style>
	body {
    	background-color: #004E9B;
	}
</style>
<script>

 function signInButton() {
	var authenticationData = {
        Username : document.getElementById("inputUsername").value,
        Password : document.getElementById("inputPassword").value,
    };
    var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);
	var poolData = {
        UserPoolId : _config.cognito.userPoolId, // Your user pool id here
        ClientId : _config.cognito.clientId, // Your client id here
    };
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
    var userData = {
        Username : document.getElementById("inputUsername").value,
        Pool : userPool,
    };
    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
	cognitoUser.authenticateUser(authenticationDetails, {
        onSuccess: function (result) {
			var accessToken = result.getAccessToken().getJwtToken();
			console.log(accessToken);
			loadPage();
//			window.open("/Users/shubhampachade/Documents/Website/Forgot Password_v1.6/profile.html");
        },
        onFailure: function(err) {
            alert(err.message || JSON.stringify(err));
        },
    });
  }
//For forget password of the existing user
 function forgotpasswordbutton(){
	var poolData = {
        UserPoolId : _config.cognito.userPoolId, // Your user pool id here
        ClientId : _config.cognito.clientId, // Your client id here
    };
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
	var modal = document.getElementById("id06");
	modal.style.display = "none";
	var modal1 = document.getElementById("id07");
    var userData = {
        Username : document.getElementById("email").value,
        Pool : userPool,
    };
    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
	 
	cognitoUser.forgotPassword({
    onSuccess: function (result) {
        console.log('call result: ' + result);
		modal1.style.display = "block";
    },
    onFailure: function(err) {
        alert(err);
    },
//    inputVerificationCode() {
//        var verificationCode = document.getElementById("code").value;
//    	var newPassword = document.getElementById("newpassword").value
//        cognitoUser.confirmPassword(verificationCode, newPassword, this);
//    }
});	
}
 function inputVerificationCode() {
	var poolData = {
        UserPoolId : _config.cognito.userPoolId, // Your user pool id here
        ClientId : _config.cognito.clientId, // Your client id here
    };
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
	var modal = document.getElementById("id07");
    var userData = {
        Username : document.getElementById("email").value,
        Pool : userPool,
    };
    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
    var verificationCode = document.getElementById("code").value;
    var newPassword = document.getElementById("newpassword").value
    cognitoUser.confirmPassword(verificationCode, newPassword, {
            onSuccess() {
                console.log('Password confirmed!');
				modal.style.display = "none";
            },
            onFailure(err) {
                console.log('Password not confirmed!');
				alert(err);
            }
        });
 }	 
// For signing up new user
 function registerButton() {
		var modal = document.getElementById("id02");
		givenname =  document.getElementById("givennameRegister").value;
		familyname =  document.getElementById("familynameRegister").value;
		username = document.getElementById("emailInputRegister").value;
		
		if (document.getElementById("passwordInputRegister").value != document.getElementById("confirmationpassword").value) {
			alert("Passwords Do Not Match!")
			throw "Passwords Do Not Match!"
		} else {
			password =  document.getElementById("passwordInputRegister").value;	
		}
		
		poolData = {
				UserPoolId : _config.cognito.userPoolId, // Your user pool id here
				ClientId : _config.cognito.clientId // Your client id here
			};		
		var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

		var attributeList = [];
		
		var dataEmail = {
			Name : 'email', 
			Value : username, //get from form field
		};
		
		var dataGivenName = {
			Name : 'given_name', 
			Value : givenname, //get from form field
		};
		var dataFamilyName = {
			Name : 'family_name', 
			Value : familyname, //get from form field
		};
		var attributeEmail = new AmazonCognitoIdentity.CognitoUserAttribute(dataEmail);
		var attributeGivenName = new AmazonCognitoIdentity.CognitoUserAttribute(dataGivenName);
		var attributeFamilyName = new AmazonCognitoIdentity.CognitoUserAttribute(dataFamilyName);
		
		
		attributeList.push(attributeEmail);
		attributeList.push(attributeGivenName);
		attributeList.push(attributeFamilyName);

		userPool.signUp(username, password, attributeList, null, function(err, result){
			if (err) {
				alert(err.message || JSON.stringify(err));
				return;
			}
			cognitoUser = result.user;
			console.log('user name is ' + cognitoUser.getUsername());
			//change elements of page
			modal.style.display = "block";
		});
	  }
 function verify(){
	var modal = document.getElementById("id02");
	modal.style.display = "none";
	var modal = document.getElementById("id03");
	var poolData = {
    	UserPoolId : _config.cognito.userPoolId, // Your user pool id here
    	ClientId : _config.cognito.clientId, // Your client id here
    };
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
    var userData = {
        Username : document.getElementById("emailInputRegister").value,
        Pool : userPool,
    };
    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
	var code = document.getElementById("OTP").value;
	cognitoUser.confirmRegistration(code, true, function(err, result) {
    if (err) {
        console.log(err);
        return;
    }
    console.log('call result: ' + result);
	if (result == 'SUCCESS') {
		modal.style.display = "block";
        return;
    }	
});
}
//For contact us Form
 function submitToAPI(e) {
       e.preventDefault();
       var URL = "https://gq1edmd7d9.execute-api.eu-central-1.amazonaws.com/dev/contactus";

            var Namere = /[A-Za-z]{1}[A-Za-z]/;
            if (!Namere.test($("#name-input").val())) {
                         alert ("Name can not less than 2 char");
                return;
            }
            var mobilere = /[0-9]{10}/;
            if (!mobilere.test($("#phone-input").val())) {
                alert ("Please enter valid mobile number");
                return;
            }
            if ($("#email-input").val()=="") {
                alert ("Please enter your email id");
                return;
            }

            var reeamil = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,6})?$/;
            if (!reeamil.test($("#email-input").val())) {
                alert ("Please enter valid email address");
                return;
            }

       var name = $("#name-input").val();
       var phone = $("#phone-input").val();
       var email = $("#email-input").val();
       var desc = $("#description-input").val();
       var data = {
          name : name,
          phone : phone,
          email : email,
          desc : desc
        };

       $.ajax({
         type: "POST",
         url : "https://gq1edmd7d9.execute-api.eu-central-1.amazonaws.com/dev/contactus",
         dataType: "json",
         cors: "true",
         contentType: "application/json; charset=utf-8",
         data: JSON.stringify(data),

         
         success: function () {
           // clear form and show a success message
		   document.getElementById('id04').style.display='none';
		   document.getElementById('id05').style.display='block';
           //alert("Successfull");
           document.getElementById("contact-form").reset();
		   document.getElementById('id05').style.display='block';
		   location.reload();
         },
         error: function () {
           // show an error message
           alert("UnSuccessfull");
         }});
     }
 function loadPage(){
     window.location="profile.html";
	}
	
 function loadPage1(){
	 location.reload();
     document.getElementById('id01').style.display='block';
	}
	
</script>	
</head>

<body>

<div class="w3-display-container">
	<img src="header.png" alt="header" class="w3-image" style="width:100%;min-height:100px;">
</div>

<div class="w3-container">
<div class="w3-row">
  <div class="w3-container w3-right">
  	<a href="https://mygoal.de/"class="w3-button  w3-round-xxlarge" style="color:#004E9B;background-color:#FFF5B3">Ãœber MyGoal Training</a>
  	<a onclick="document.getElementById('id01').style.display='block'" class="w3-button  w3-round-xxlarge" style="color:#004E9B;background-color:#FFDF00">Login</a>
  </div>
</div>
		
<div class="w3-row-padding">
	<div class="w3-display-container ">	
	<form class="w3-transparent w3-margin-top w3-margin-bottom w3-display-topmiddle w3-border w3-border w3-round-xlarge" style="width:100%;max-width:900px;">
		<div class="w3-full w3-section w3-margin">
			<h6 class = "w3-text-white">Das erst mal hier? Dann leg schnell und unkompliziert dein Profil an:</h6>
    		<label class = "w3-text-white">E-mail</label>
			<input class="w3-input w3-border w3-round" type="text" id="emailInputRegister" pattern=".*" required> 
<!--		<input class="w3-input w3-border w3-round w3-text-white" style="background-color:#004E9B" type="text" required> -->

  		</div>

		<div class="w3-row-padding w3-mobile">
  			<div class="w3-half">   
    			<label class = "w3-text-white">Vorname</label>
   				<input class="w3-input w3-border w3-round" type="text" id="givennameRegister" pattern=".*" required>
<!--	<input class="w3-input w3-border w3-round w3-text-white" style="background-color:#004E9B" type="text" required>-->

			</div>
			<div class="w3-half">  
				<label class = "w3-text-white">Nachname</label>
    			<input class="w3-input w3-border w3-round" type="text" id="familynameRegister" pattern=".*" required>
<!--	<input class="w3-input w3-border w3-round w3-text-white" style="background-color:#004E9B" type="text"  required>-->

			</div>
		</div>
<!--	W3 Modal for Login page-->
		<div id="id01" class="w3-modal">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:600px;">
		  <header class="w3-container"> 
			<span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			<h2></h2>
		  </header>
		  <div class="w3-container">
			<label>E-mail</label>
			<input class="w3-input w3-border w3-round w3-margin-bottom" type="text" id="inputUsername" name="username" required autofocus>
			<label>Passwort</label>
			<input class="w3-input w3-border w3-round" type="password" id="inputPassword" name="password" required>
			<p onclick="document.getElementById('id06').style.display='block',document.getElementById('id01').style.display='none'" class = "w3-right w3-button"> <u>Passwort vergessen</u></p> 
			<div class="w3-row w3-center">
				<a onclick="signInButton()" class="w3-button w3-round-xlarge w3-margin-bottom" style="color:#004E9B;background-color:#FFDF00">Login</a> 
			</div>
		  </div>
		</div>
		</div>
<!--	W3 Modal for Password vergessen-->
		<div id="id06" class="w3-modal">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:600px;">
		  <header class="w3-container"> 
			<br>
			<span onclick="document.getElementById('id06').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			  <h2></h2>
		  </header>
		  <div class="w3-container">
			<label>E-mail</label>
			<input class="w3-input w3-border w3-round w3-margin-bottom" type="text" id="email" name="username" required autofocus>
			<div class="w3-row w3-center">
				<a onclick="forgotpasswordbutton()" class="w3-button w3-round-xlarge w3-margin-bottom" style="color:#004E9B;background-color:#FFDF00">Receive Verification Code</a> 
			</div>
		  </div>
		</div>
		</div>
<!--	W3 Modal for verification Code for forget password -->
		<div id="id07" class="w3-modal w3-padding-48">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:700px;">
		   
			<span onclick="document.getElementById('id07').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			<h2></h2>
		  
		  <div class="w3-container w3-center">
		  	<p class="w3-text-green"><i class="fa fa-check w3-green" aria-hidden="true"></i><span> </span>Registriert</p>
			<p>Danke fÃ¼r deine Anmeldung!</p>
			<p>Wir haben dir soeben 6-stelligen Verifizierungscode per E-mail zugeschickt.
				(PrÃ¼fe deinen Spam-filter,falls du ihn im Posteingang nicht findest.)
				Gib ihn bitte hier ein, um deine Registrierung abzuschlieÃŸen:
			</p>
		  </div> 
		  <div class="w3-container">
			<input class="w3-input w3-border w3-round" type="text" id="code" pattern=".*" required>
			<label>Neue Passwort</label>
			<input class="w3-input w3-border w3-round" type="password" id="newpassword"  placeholder="Password"  >
			<p onclick="" class = "w3-right-align"> <u>Neuen code zusenden</u></p> 
			<div class="w3-row w3-center">
				<a onclick="inputVerificationCode()" class="w3-button w3-round-xlarge " style="color:#004E9B;background-color:#FFDF00">Change Password</a> 
			</div>
		  </div>
		</div>
		</div>
<!--	W3 Modal for verification Code for sign up-->
		<div id="id02" class="w3-modal w3-padding-48">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:700px;">
		   
<!--			<span onclick="document.getElementById('id02').style.display='none'" class="w3-button w3-display-topright">&times;</span>-->
			<h2></h2>
		  
		  <div class="w3-container w3-center">
		  	<p class="w3-text-green"><i class="fa fa-check w3-green" aria-hidden="true"></i><span> </span>Registriert</p>
			<p>Danke fÃ¼r deine Anmeldung!</p>
			<p>Wir haben dir soeben 6-stelligen Verifizierungscode per E-mail zugeschickt.
				(PrÃ¼fe deinen Spam-filter,falls du ihn im Posteingang nicht findest.)
				Gib ihn bitte hier ein, um deine Registrierung abzuschlieÃŸen:
			</p>
		  </div> 
		  <div class="w3-container">
			<input class="w3-input w3-border w3-round" type="number" id="OTP" pattern=".*" required>
			<p onclick="" class = "w3-right-align"> <u>Neuen code zusenden</u></p> 
			<div class="w3-row w3-center">
				<a onclick="verify()" class="w3-button w3-round-xlarge " style="color:#004E9B;background-color:#FFDF00">Weiter</a> 
			</div>
		  </div>
		</div>
		</div>
<!--	W3 Modal for Registration completed-->
		<div id="id03" class="w3-modal w3-padding-48">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:700px;">
			<span onclick="document.getElementById('id03').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			<h2> </h2> 
		  <div class="w3-container w3-center">
		  	<p class="w3-text-green"><i class="fa fa-check w3-green" aria-hidden="true"></i><span> </span>Verifiziert</p>
			<p>Na dann: Herzlich Willkommen!</p>
			<p>Ab jetzt kannst du dich mit deiner E-mail Address und deinem Passwort jederzeit einloggen </p>
		  </div>
		  <div class="w3-row w3-center">
		  <a onclick="document.getElementById('id03').style.display='none',document.getElementById('id01').style.display='block'" class="w3-button w3-round-xlarge w3-margin-bottom" style="color:#004E9B;background-color:#FFDF00">Login</a> 
	   	  </div>
		</div>
		</div>
<!--	W3 Modal for contact us form-->
		<div id="id04" class="w3-modal w3-padding-16 ">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:600px;">
		  <header class="w3-container"> 
			<span onclick="document.getElementById('id04').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			<h6>Wie kÃ¶nnen wir dir helfen?</h6>
		  </header>
		  <div class="w3-container">
<!--			<div class="w3-row-padding w3-mobile">-->
  			<div class="w3-half">   
    			<label>Name</label>
   				<input class="w3-input w3-border w3-round" id="name-input" style="width:98%" type="text" required>
			</div>
			<div class="w3-half">  
				<label>Phone</label>
    			<input class="w3-input w3-border w3-round" id="phone-input" style="width:99%" type="text"  required>
			</div>
<!--			</div>-->
			<label>E-mail</label>
			<input class="w3-input w3-border w3-round w3-margin-bottom" id="email-input" type="text" required>
			<label>Nachricht</label>
			<textarea class="w3-input w3-border w3-round" id="description-input" style="width:100%" name="Text1" rows="5"></textarea>
			<div class="w3-row w3-center">
				<a onclick="submitToAPI(event)" class="w3-button w3-round-xlarge w3-margin-bottom" style="color:#004E9B;background-color:#FFDF00">Senden</a> 
			</div>
		  </div>
		</div>
		</div>
<!--	W3 Modal for contact_us form completion-->
		<div id="id05" class="w3-modal w3-padding-48">
		<div class="w3-modal-content w3-card-4 w3-round-large" style="width:100%;max-width:700px;">
			<span onclick="document.getElementById('id05').style.display='none'" class="w3-button w3-display-topright">&times;</span>
			<h2> </h2> 
		  <div class="w3-container w3-center">
		  	<p class="w3-text-green"><i class="fa fa-check w3-green" aria-hidden="true"></i><span> </span>Versendet</p>
			<p>Danke fÃ¼r deine Nachricht!</p>
			<p>Wir melden uns innerhalb der nÃ¤chsten 48h bei dir.</p>
		  </div> 
		</div>
		</div>
<!--		W3 modals end-->
		
		<div class="w3-row-padding w3-margin-top w3-mobile">
			<div class="w3-half">  
				<label class = "w3-text-white">Passwort</label>
    			<input class="w3-input w3-border w3-round" type="password" id="passwordInputRegister" pattern=".*" required>
<!--			<input class="w3-input w3-border w3-round w3-text-white" style="background-color:#004E9B" type="new-password"  required>-->
			</div>
			<div class="w3-half">  
				<label class = "w3-text-white">Passwort wiederholen</label>
   				<input class="w3-input w3-border w3-round" type="password" id="confirmationpassword" pattern=".*"  required>
<!--			<input class="w3-input w3-border w3-round w3-text-white" style="background-color:#004E9B" type="new-password"  required>-->
			</div>
		</div>
		<br>
		<div class="w3-row-padding w3-center w3-margin-top w3-mobile">
			<a onclick="registerButton()" class="w3-button w3-round-xxlarge" style="color:#004E9B;background-color:#FFDF00">Profil anlagen</a>
		</div>
		
		<div class="w3-row-padding w3-center w3-margin-top w3-mobile">
			<h6 class = "w3-text-white">Du mÃ¶chest erstmal loswerden, ohne dich zu registrieren? <a onclick="document.getElementById('id04').style.display='block'" class="w3-button w3-round-xxlarge" style="color:#004E9B;background-color:#FFDF00">Schreib uns</a></h6>
		</div>
		
		
	</form>
	</div>
</div>
</div>
</body>
</html>
